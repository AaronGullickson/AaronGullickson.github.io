<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Base Plot | Statistical Analysis in Sociology</title>
  <meta name="description" content="Textbook for Statistical Analysis for University of Oregon Sociology">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Base Plot | Statistical Analysis in Sociology />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Textbook for Statistical Analysis for University of Oregon Sociology" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Base Plot | Statistical Analysis in Sociology />
  
  <meta name="twitter:description" content="Textbook for Statistical Analysis for University of Oregon Sociology" />
  

<meta name="author" content="Aaron Gullickson">


<meta name="date" content="2019-03-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="pretty-pictures.html">
<link rel="next" href="ggplot.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="understanding-data.html"><a href="understanding-data.html"><i class="fa fa-check"></i>Understanding Data</a><ul>
<li class="chapter" data-level="" data-path="what-does-data-look-like.html"><a href="what-does-data-look-like.html"><i class="fa fa-check"></i>What Does Data Look Like?</a><ul>
<li class="chapter" data-level="" data-path="what-does-data-look-like.html"><a href="what-does-data-look-like.html#the-observations"><i class="fa fa-check"></i>The observations</a></li>
<li class="chapter" data-level="" data-path="what-does-data-look-like.html"><a href="what-does-data-look-like.html#the-variables"><i class="fa fa-check"></i>The variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html"><i class="fa fa-check"></i>What Can We Do With Data?</a><ul>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#how-is-a-variable-distributed"><i class="fa fa-check"></i>How is a variable distributed?</a></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#measuring-association"><i class="fa fa-check"></i>Measuring association</a></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#making-statistical-inferences"><i class="fa fa-check"></i>Making statistical inferences</a></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#building-models"><i class="fa fa-check"></i>Building Models</a></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#observational-data-experimental-thinking"><i class="fa fa-check"></i>Observational Data, Experimental Thinking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-distribution-of-a-variable.html"><a href="the-distribution-of-a-variable.html"><i class="fa fa-check"></i>The Distribution of a Variable</a><ul>
<li class="chapter" data-level="" data-path="what-is-a-distribution.html"><a href="what-is-a-distribution.html"><i class="fa fa-check"></i>What is a Distribution?</a><ul>
<li class="chapter" data-level="" data-path="what-is-a-distribution.html"><a href="what-is-a-distribution.html#looking-at-the-distribution-of-a-categorical-variable"><i class="fa fa-check"></i>Looking at the distribution of a categorical variable</a></li>
<li class="chapter" data-level="" data-path="what-is-a-distribution.html"><a href="what-is-a-distribution.html#looking-at-the-distribution-of-a-quantitative-variable"><i class="fa fa-check"></i>Looking at the distribution of a quantitative variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html"><i class="fa fa-check"></i>Measuring the Center of a Distribution</a><ul>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html#the-mean"><i class="fa fa-check"></i>The mean</a></li>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html#the-median"><i class="fa fa-check"></i>The median</a></li>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html#the-mode"><i class="fa fa-check"></i>The mode</a></li>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html#comparing-the-mean-and-median"><i class="fa fa-check"></i>Comparing the mean and median</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="percentiles-and-the-five-number-summary.html"><a href="percentiles-and-the-five-number-summary.html"><i class="fa fa-check"></i>Percentiles and the Five Number Summary</a><ul>
<li class="chapter" data-level="" data-path="percentiles-and-the-five-number-summary.html"><a href="percentiles-and-the-five-number-summary.html#percentiles"><i class="fa fa-check"></i>Percentiles</a></li>
<li class="chapter" data-level="" data-path="percentiles-and-the-five-number-summary.html"><a href="percentiles-and-the-five-number-summary.html#the-five-number-summary"><i class="fa fa-check"></i>The five number summary</a></li>
<li class="chapter" data-level="" data-path="percentiles-and-the-five-number-summary.html"><a href="percentiles-and-the-five-number-summary.html#boxplots"><i class="fa fa-check"></i>Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="measuring-the-spread-of-a-distribution.html"><a href="measuring-the-spread-of-a-distribution.html"><i class="fa fa-check"></i>Measuring the Spread of a Distribution</a><ul>
<li class="chapter" data-level="" data-path="measuring-the-spread-of-a-distribution.html"><a href="measuring-the-spread-of-a-distribution.html#range-and-interquartile-range"><i class="fa fa-check"></i>Range and interquartile range</a></li>
<li class="chapter" data-level="" data-path="measuring-the-spread-of-a-distribution.html"><a href="measuring-the-spread-of-a-distribution.html#variance-and-standard-deviation"><i class="fa fa-check"></i>Variance and standard deviation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="measuring-association-1.html"><a href="measuring-association-1.html"><i class="fa fa-check"></i>Measuring Association</a><ul>
<li class="chapter" data-level="" data-path="the-two-way-table.html"><a href="the-two-way-table.html"><i class="fa fa-check"></i>The Two-Way Table</a><ul>
<li class="chapter" data-level="" data-path="the-two-way-table.html"><a href="the-two-way-table.html#conditional-distributions"><i class="fa fa-check"></i>Conditional distributions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="odds-ratio-advanced.html"><a href="odds-ratio-advanced.html"><i class="fa fa-check"></i>Odds ratio (Advanced)</a></li>
<li class="chapter" data-level="" data-path="mean-differences.html"><a href="mean-differences.html"><i class="fa fa-check"></i>Mean Differences</a><ul>
<li class="chapter" data-level="" data-path="mean-differences.html"><a href="mean-differences.html#graphically-examining-differences-in-distributions"><i class="fa fa-check"></i>Graphically examining differences in distributions</a></li>
<li class="chapter" data-level="" data-path="mean-differences.html"><a href="mean-differences.html#comparing-differences-in-the-mean"><i class="fa fa-check"></i>Comparing differences in the mean</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scatterplot-and-correlation-coefficient.html"><a href="scatterplot-and-correlation-coefficient.html"><i class="fa fa-check"></i>Scatterplot and Correlation Coefficient</a><ul>
<li class="chapter" data-level="" data-path="scatterplot-and-correlation-coefficient.html"><a href="scatterplot-and-correlation-coefficient.html#the-scatterplot"><i class="fa fa-check"></i>The scatterplot</a></li>
<li class="chapter" data-level="" data-path="scatterplot-and-correlation-coefficient.html"><a href="scatterplot-and-correlation-coefficient.html#the-correlation-coefficient"><i class="fa fa-check"></i>The correlation coefficient</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i>Statistical Inference</a><ul>
<li class="chapter" data-level="" data-path="the-problem-of-statistical-inference.html"><a href="the-problem-of-statistical-inference.html"><i class="fa fa-check"></i>The Problem of Statistical Inference</a></li>
<li class="chapter" data-level="" data-path="the-concept-of-the-sampling-distribution.html"><a href="the-concept-of-the-sampling-distribution.html"><i class="fa fa-check"></i>The Concept of the Sampling Distribution</a><ul>
<li class="chapter" data-level="" data-path="the-concept-of-the-sampling-distribution.html"><a href="the-concept-of-the-sampling-distribution.html#example-class-height"><i class="fa fa-check"></i>Example: class height</a></li>
<li class="chapter" data-level="" data-path="the-concept-of-the-sampling-distribution.html"><a href="the-concept-of-the-sampling-distribution.html#central-limit-theorem-and-the-normal-distribution"><i class="fa fa-check"></i>Central limit theorem and the normal distribution</a></li>
<li class="chapter" data-level="" data-path="the-concept-of-the-sampling-distribution.html"><a href="the-concept-of-the-sampling-distribution.html#what-can-we-do-with-the-sampling-distribution"><i class="fa fa-check"></i>What can we do with the sampling distribution?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i>Confidence Intervals</a><ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#what-do-we-mean-by-confident"><i class="fa fa-check"></i>What do we mean by “confident?”</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#calculating-the-confidence-interval-for-the-sample-mean"><i class="fa fa-check"></i>Calculating the confidence interval for the sample mean</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#calculating-the-confidence-interval-for-other-sample-statistics"><i class="fa fa-check"></i>Calculating the confidence interval for other sample statistics</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#example-with-proportions"><i class="fa fa-check"></i>Example with proportions</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#example-with-mean-differences"><i class="fa fa-check"></i>Example with mean differences</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#example-with-proportion-differences"><i class="fa fa-check"></i>Example with proportion differences</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#example-with-correlation-coefficient"><i class="fa fa-check"></i>Example with correlation coefficient</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i>Hypothesis Tests</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#example-coke-winners"><i class="fa fa-check"></i>Example: Coke winners</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#the-general-procedure-of-hypothesis-testing"><i class="fa fa-check"></i>The general procedure of hypothesis testing</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#hypothesis-tests-of-relationships"><i class="fa fa-check"></i>Hypothesis tests of relationships</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-models-1.html"><a href="building-models-1.html"><i class="fa fa-check"></i>Building Models</a><ul>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html"><i class="fa fa-check"></i>The OLS Regression Line</a><ul>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#the-formula-for-a-line"><i class="fa fa-check"></i>The Formula for a Line</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#calculating-the-best-fitting-line"><i class="fa fa-check"></i>Calculating the Best-Fitting Line</a></li>
<li><a href="the-ols-regression-line.html#using-the-lm-command-to-calculate-ols-regression-lines-in-r">Using the <code>lm</code> command to calculate OLS regression lines in <em>R</em></a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#the-ols-regression-line-as-a-model"><i class="fa fa-check"></i>The OLS regression line as a model</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#interpeting-slopes-and-intercepts"><i class="fa fa-check"></i>Interpeting Slopes and Intercepts</a></li>
<li><a href="the-ols-regression-line.html#how-good-is-x-as-a-predictor-of-y">How good is <span class="math inline">\(x\)</span> as a predictor of <span class="math inline">\(y\)</span>?</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#inference-for-ols-regression-models"><i class="fa fa-check"></i>Inference for OLS Regression models</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#regression-line-cautions"><i class="fa fa-check"></i>Regression Line Cautions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-power-of-controlling-for-other-variables.html"><a href="the-power-of-controlling-for-other-variables.html"><i class="fa fa-check"></i>The Power of Controlling for Other Variables</a><ul>
<li class="chapter" data-level="" data-path="the-power-of-controlling-for-other-variables.html"><a href="the-power-of-controlling-for-other-variables.html#interpreting-results-in-a-multivariate-ols-regression-models"><i class="fa fa-check"></i>Interpreting results in a multivariate OLS regression models</a></li>
<li class="chapter" data-level="" data-path="the-power-of-controlling-for-other-variables.html"><a href="the-power-of-controlling-for-other-variables.html#including-more-than-two-independent-variables"><i class="fa fa-check"></i>Including more than two independent variables</a></li>
<li class="chapter" data-level="" data-path="the-power-of-controlling-for-other-variables.html"><a href="the-power-of-controlling-for-other-variables.html#how-to-read-a-table-of-regression-results"><i class="fa fa-check"></i>How to read a table of regression results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="including-categorical-variables-as-predictors.html"><a href="including-categorical-variables-as-predictors.html"><i class="fa fa-check"></i>Including Categorical Variables as Predictors</a><ul>
<li class="chapter" data-level="" data-path="including-categorical-variables-as-predictors.html"><a href="including-categorical-variables-as-predictors.html#indicator-variables"><i class="fa fa-check"></i>Indicator variables</a></li>
<li class="chapter" data-level="" data-path="including-categorical-variables-as-predictors.html"><a href="including-categorical-variables-as-predictors.html#categorical-variables-with-more-than-two-categories"><i class="fa fa-check"></i>Categorical variables with more than two categories</a></li>
<li class="chapter" data-level="" data-path="including-categorical-variables-as-predictors.html"><a href="including-categorical-variables-as-predictors.html#categorical-and-quantitative-variables-combined-in-a-single-model"><i class="fa fa-check"></i>Categorical and quantitative variables combined in a single model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html"><i class="fa fa-check"></i>Interaction Terms</a><ul>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#the-nature-of-additive-models"><i class="fa fa-check"></i>The nature of additive models</a></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#the-interaction-term"><i class="fa fa-check"></i>The interaction term</a></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#interpreting-interaction-terms"><i class="fa fa-check"></i>Interpreting interaction terms</a></li>
<li><a href="interaction-terms.html#interaction-terms-in-r">Interaction terms in <em>R</em></a></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#interaction-terms-with-multiple-categories"><i class="fa fa-check"></i>Interaction terms with multiple categories</a></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#interaction-terms-with-two-categorical-variables"><i class="fa fa-check"></i>Interaction terms with two categorical variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-scripts.html"><a href="using-scripts.html"><i class="fa fa-check"></i>Using Scripts</a><ul>
<li class="chapter" data-level="" data-path="getting-started-with-scripts.html"><a href="getting-started-with-scripts.html"><i class="fa fa-check"></i>Getting Started with Scripts</a><ul>
<li class="chapter" data-level="" data-path="getting-started-with-scripts.html"><a href="getting-started-with-scripts.html#not-everything-goes-into-your-script"><i class="fa fa-check"></i>Not Everything Goes Into Your Script</a></li>
<li class="chapter" data-level="" data-path="getting-started-with-scripts.html"><a href="getting-started-with-scripts.html#commenting-for-sanity"><i class="fa fa-check"></i>Commenting for Sanity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html"><i class="fa fa-check"></i>Object Types</a><ul>
<li class="chapter" data-level="" data-path="atomic-modes.html"><a href="atomic-modes.html"><i class="fa fa-check"></i>Atomic Modes</a></li>
<li class="chapter" data-level="" data-path="vectors-and-matrices.html"><a href="vectors-and-matrices.html"><i class="fa fa-check"></i>Vectors and Matrices</a><ul>
<li class="chapter" data-level="" data-path="vectors-and-matrices.html"><a href="vectors-and-matrices.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="vectors-and-matrices.html"><a href="vectors-and-matrices.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="vectors-and-matrices.html"><a href="vectors-and-matrices.html#indexing-vectors-and-matrices"><i class="fa fa-check"></i>Indexing Vectors and Matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i>Factors</a><ul>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html#re-ordering-categories-in-factors"><i class="fa fa-check"></i>Re-ordering categories in factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logical-values-and-boolean-statements.html"><a href="logical-values-and-boolean-statements.html"><i class="fa fa-check"></i>Logical Values and Boolean Statements</a></li>
<li class="chapter" data-level="" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i>Missing Values</a></li>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html"><i class="fa fa-check"></i>Lists</a><ul>
<li class="chapter" data-level="" data-path="lists.html"><a href="lists.html#accessing-elements-of-the-list"><i class="fa fa-check"></i>Accessing elements of the list</a></li>
<li><a href="lists.html#the-lapply-command-is-awesome">The <code>lapply</code> command is awesome</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i>Data Frames</a><ul>
<li><a href="data-frames.html#renaming-variables-in-a-data.frame">Renaming Variables in a <code>data.frame</code></a></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#subsetting-data-frames"><i class="fa fa-check"></i>Subsetting Data Frames</a></li>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#subsetting-by-variables"><i class="fa fa-check"></i>Subsetting by variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="pretty-pictures.html"><a href="pretty-pictures.html"><i class="fa fa-check"></i>Pretty Pictures</a><ul>
<li class="chapter" data-level="" data-path="base-plot.html"><a href="base-plot.html"><i class="fa fa-check"></i>Base Plot</a></li>
<li class="chapter" data-level="" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i>ggplot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i>Reading and Writing Data</a><ul>
<li class="chapter" data-level="" data-path="data-formats.html"><a href="data-formats.html"><i class="fa fa-check"></i>Data Formats</a></li>
<li class="chapter" data-level="" data-path="plain-text-files.html"><a href="plain-text-files.html"><i class="fa fa-check"></i>plain text files</a><ul>
<li class="chapter" data-level="" data-path="plain-text-files.html"><a href="plain-text-files.html#working-with-csv-files"><i class="fa fa-check"></i>Working with CSV files</a></li>
<li class="chapter" data-level="" data-path="plain-text-files.html"><a href="plain-text-files.html#working-with-fixed-width-text-files"><i class="fa fa-check"></i>Working with fixed-width text files</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-in-binary-format.html"><a href="data-in-binary-format.html"><i class="fa fa-check"></i>Data in binary format</a></li>
<li class="chapter" data-level="" data-path="saving-data.html"><a href="saving-data.html"><i class="fa fa-check"></i>Saving data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Analysis in Sociology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="base-plot" class="section level2">
<h2>Base Plot</h2>
<p>For this example, we are going to use a scatterplot to look at the association between funding per capita and poverty rates. Here is the ultimate figure that we want to end up with:</p>
<p><img src="stat_book_files/figure-html/prettyfull-1.png" width="672" /></p>
<p>There is a lot going on in this figure. Lets identify a few of the nifty features:</p>
<ul>
<li>dots are color-coded by borough</li>
<li>the scale of the y-axis is <em>logarithmic</em> which means that an increase of one unit is actually a multiplicative increase of 10 (sort of like the richter scale).</li>
<li>The size of dots is scaled to the population size of the health area.</li>
<li>There is a best-fitting line drawn through the points. It looks positive.</li>
<li>the y-axis has a dollar-sign and commas to make the numbers easier to read and the x-axis has a % marker to make clear the units.</li>
<li>there are two different legends drawn on the outside margins of the figure.</li>
</ul>
<p>Thats a lot of stuff. Lets start from the basics and build our way up to this final model. Lets start by just running the basic <code>plot</code> command for a scatterplot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita)</code></pre>
<p><img src="stat_book_files/figure-html/pretty1-1.png" width="672" /></p>
<p>Ok, thats a lot different. Lets deal with the biggest substantive problem. The amount per capita is so heavily right-skewed that it is difficult to see the relationship because almost all of the data points are “squished” down at the bottom of the y-axis. This can be resolved by using whats called a <em>logarithmic scale</em> such that each tick mark indicates not an additive unit increase on the y-axis but a multiplicative increase. We can do this easily by specifying “y” as an option to the <code>log</code> argument in <code>plot</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>)</code></pre>
<p><img src="stat_book_files/figure-html/pretty2-1.png" width="672" /></p>
<p>Ok, that looks better. This graphical approach is related to the idea of <strong>tranformations</strong> that we will discuss later in the term. Now we can better see that there is a positive effect. However, the numbers on the y-axis tick-marks look horrible. Instead of using the default tickmarks, I can specify my own axis. A quick check using <code>summary</code> reveals that the maximum amount per capita is $12,290. If I am going up by multiples of ten, the next tick mark above this would be 100,000 (from 10,000, to 100,000). So, I am going to do a few things in the next command. First, I am going to use <code>yaxt="n"</code> to tell R not to draw the default y-axis. Then I am going to use <code>ylim=c(0.1,100000)</code> to specify the upper and lower limits on my y-axis.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>))</code></pre>
<p><img src="stat_book_files/figure-html/pretty3-1.png" width="672" /></p>
<p>Notice that there is now no y-axis tickmarks. I can define those myself with the <code>axis</code> command.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>))
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">1</span>)</code></pre>
<p><img src="stat_book_files/figure-html/pretty4-1.png" width="672" /></p>
<p>The <code>2</code> argument tells R to draw the axis for the y-axis and the <code>at</code> argument allows me to specify where I want the tick marks. The <code>las</code> argument specifies that I want my tickmark labels to be perpendicular to the axis, for easier reading. There are still a couple of problems with this axis. First, the label for the y-axis is now overlapping with the tickmark labels. Second, the tickmark labels are in an ugly exponential notation. These can both be fixed. First, I can fix the tickmark labels. There are a variety of functions such as <code>paste</code>, <code>format</code>, and <code>formatC</code> which will allow you to turn numbers into pretty well-formatted character strings. In this case, I am going to use those functions to write out the full number with a comma at the thousands place and put a dollar sign in front:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>))
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p><img src="stat_book_files/figure-html/pretty5-1.png" width="672" /></p>
<p>I am not going to go over the details of these commands here, but you can see how the tickmark labels are much easier to read now. I still have the problem of the overlapping label for the y-axis and now, the left margin is also not quite large enough for the top label which is being cut-off.</p>
<p>To adjust the margin, let me introduce the <code>par</code> command. The <code>par</code> command can be called before the plot command to set up the parameters of the plot. If you look at the help file for <code>par</code> you will see that there are a huge number of parameters that we can adjust. In our case, we want to adjust the <code>mar</code> argument which is a vector of four numbers defining the size of the bottom, left, top, and right margins, respectively. The default for these is <code>c(5,4,4,2)</code>. I will increase the left margin slightly and reduce the right margin since we won’t use it. In addition, I am going to remove the default y label by specifying <code>ylab=""</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>)
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p><img src="stat_book_files/figure-html/pretty6-1.png" width="672" /></p>
<p>The final step is to define my own y-axis label. I can do this with the <code>title</code> command. If you look at the help file for the <code>title</code> command, you will see that in addition to telling R which title you want to add, you can specify the number of lines away from the graph for the title, which allows us to control its placement. After experimenting around a bit, I discovered that <code>line=5</code> looked nice.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</code></pre>
<p><img src="stat_book_files/figure-html/pretty7-1.png" width="672" /></p>
<p>The y-axis now looks pretty good. I was able to override the default y-axis with the <code>yaxt="n"</code> and <code>ylab=""</code> arguments to <code>plot</code> and then use the <code>axis</code> and <code>title</code> commands to customize tick marks and labels. Now, I will do the same to the x-axis:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,
     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>)
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p><img src="stat_book_files/figure-html/pretty8-1.png" width="672" /></p>
<p>In this case, I didn’t have to define a separate title, because the default x-axis label fits fine. I also don’t need the <code>las</code> command because the default has the correct alignment.</p>
<p>Now that I have my axes well-labeled. I can focus on the actual plot. The default “dots” for scatterplots in R are prety ugly, but there are lots of options for better dots. You can specify the shape and style of the dot with the <code>pch</code> argument in plot. If you use <code>?points</code>, the help file will give you a list of the numeric codes that correspond to different kinds of dots. I usually use <code>pch=21</code> because it will give me a circle that has a separate border and fill color. The border color can be specified by the <code>col</code> argument an the fill color can be specified by the <code>bg</code> argument. I can also use the <code>cex</code> option to define the size of the dots (relative to the default of 1). I will use this now to create circles of half the average size with a red fill and a black border.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(nyc<span class="op">$</span>amtcapita))<span class="op">~</span>nyc<span class="op">$</span>poverty)
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,
     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&quot;red&quot;</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="fl">0.5</span>)
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p><img src="stat_book_files/figure-html/pretty9-1.png" width="672" /></p>
<p>This is now pretty good, but the final touch here is to vary the size of the dots by the size of the health area and the fill color by the borough of the health area. R is very flexible about these types of arguments. If I give a vector of numbers for the size or a vector of colornames for the fill color, R will assume that those colors correspond to the individual dots and will allow for variation in the size and color. For example, lets just feed in population size divided by 10,000 to <code>cex</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,
     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&quot;red&quot;</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span>nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">10000</span>)
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p><img src="stat_book_files/figure-html/pretty10-1.png" width="672" /></p>
<p>Well, that sort of worked but some of those dots are way too big and some are way too small. The variation in size between health areas is so large that any kind of linear scaling of the population size is going to result in this problem. There are a variety of potential solutions to this, but our earlier use of logarithmic scales suggests an easy one. Logging the population values will allow for differences in size but at a diminishing scale difference. After experimentation, I decided that dividing population size by 3000 and logging with a base of 5 produced good size variation.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,
     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&quot;red&quot;</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>))
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p><img src="stat_book_files/figure-html/pretty11-1.png" width="672" /></p>
<p>The final step is to color-code the dots. I could put in a vector of any five colors. However, it is important to think about accessibility for color-blind individuals and whether a color combination will show up well in print. There are many online resources for this sort of thing. I like <a href="http://colorbrewer2.org/#type=diverging&amp;scheme=RdBu&amp;n=5">ColorBrewer</a>. Here I have specified five classes with a diverging scheme that are colorblind and print friendly. I wiould have selected qualitative scale but there are no color-blind options in that category for five classes. ColorBrewer gives me some options with hexadecimal color codes which I can feed into R. I first create a vector of the five color names and then I use the borough index to assign them in my plot command.</p>
<pre class="sourceCode r"><code class="sourceCode r">color_choices &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#ca0020&quot;</span>,<span class="st">&quot;#f4a582&quot;</span>,<span class="st">&quot;#f7f7f7&quot;</span>,<span class="st">&quot;#92c5de&quot;</span>,<span class="st">&quot;#0571b0&quot;</span>)
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,
     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>color_choices[nyc<span class="op">$</span>borough], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>))
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p><img src="stat_book_files/figure-html/pretty12-1.png" width="672" />
We are almost there but I also want to add a best-fitting line. Normally, I could do this with the <code>abline</code> command as discussed in the Canvas section on the OLS regression line. However, that won’t work in this case because of the the logarithmic scale on the y-axis. Instead, I can create a sequence of poverty rate values and then based on a model, I can calculate the predicted amount per capita (note that you don’t know how to do this yet, so just hang tight). I can then feed those x and y values into a <code>lines</code> command to draw a line on my plot.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(nyc<span class="op">$</span>amtcapita))<span class="op">~</span>nyc<span class="op">$</span>poverty)
x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">60</span>
y &lt;-<span class="st"> </span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">1</span>])<span class="op">*</span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">2</span>])<span class="op">^</span>x
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,
     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>color_choices[nyc<span class="op">$</span>borough], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>), 
     <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">lines</span>(x,y, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;grey20&quot;</span>)</code></pre>
<p><img src="stat_book_files/figure-html/pretty14-1.png" width="672" /></p>
<p>I don’t want you to worry to much about the model part. The important feature I want to highlight here is that <code>lines</code> is one of a number of commands that include <code>points</code>, <code>text</code>, and <code>mtext</code> that you can use to later add other stuff to a plot that you have already made. In this case, I have added a straight line. The <code>lwd</code> argument defines the width of the line and the <code>col</code> argument defines the color of the line.</p>
<p>I snuck in one other argument here that made a noticeable change. The argument <code>bty</code> defines how the border is drawn around the overall plot area. By setting this to “n”, I removed the border altogether, which I think gives it a cleaner look.</p>
<p>The last step is to add some legends. Legends can be tricky. The first thing you have to figure out is where to place the legend. In my case, I would rather have the legend in the margin than in the main plot area, but R won’t do this by default. In order to do that, I need to specify an <code>xpd=TRUE</code> argument in the <code>par</code> command to allow writing output to the margins and not just the main plot area. In the <code>legend</code> command itself, I need to make a label for each component of the legend and then I need to specify how each component is identified. Lets start with the legend for boroughs.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(nyc<span class="op">$</span>amtcapita))<span class="op">~</span>nyc<span class="op">$</span>poverty)
x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">60</span>
y &lt;-<span class="st"> </span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">1</span>])<span class="op">*</span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">2</span>])<span class="op">^</span>x
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">xpd=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,
     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>color_choices[nyc<span class="op">$</span>borough], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>), 
     <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">lines</span>(x,y, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;grey20&quot;</span>)
lg &lt;-<span class="st"> </span><span class="kw">legend</span>(<span class="dv">0</span>, <span class="dv">100000</span>, 
             <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Manhattan&quot;</span>,<span class="st">&quot;Bronx&quot;</span>,<span class="st">&quot;Brooklyn&quot;</span>,<span class="st">&quot;Queens&quot;</span>,<span class="st">&quot;Staten Island&quot;</span>), 
             <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">pt.bg=</span>color_choices, <span class="dt">ncol=</span><span class="dv">5</span>, 
             <span class="dt">cex=</span><span class="fl">0.45</span>, <span class="dt">pt.cex=</span><span class="fl">1.2</span>, <span class="dt">yjust=</span><span class="dv">5</span>)</code></pre>
<p><img src="stat_book_files/figure-html/pretty15-1.png" width="672" /></p>
<p>The first two arguments to <code>legend</code> give the x and y placement. The <code>legend</code> argument to <code>legend</code> (I know, its weird) gives the labels for the legend components. The <code>pch</code> argument tells the legend that I am using points and what their shape is. The <code>col</code> argument gives the border color for these points and the <code>pt.bg</code> argument gives their fill color. The <code>ncol</code> tells the legend to use five separate columns rather than a vertical alignment all in one column. The <code>cex</code> and <code>pt.cex</code> arguments indicate the size of the overall legend and the size of the dots, respectively. The <code>yjust</code> argument allows me to fudge the placement to get it just right.</p>
<p>Notice, that I saved the output of legend to an object that I called <code>lg</code>. This is a very useful feature of plots. I want to draw my next legend for health area size next to this first legend, but I have no idea exactly how big the first legend will be, so its hard to know at what value of x to start it. I could guess a number here, but that might also change if I rescale the figure manually. However, if I look at the <code>lg</code> object, the information I am looking for is returned there:</p>
<pre class="sourceCode r"><code class="sourceCode r">lg</code></pre>
<pre><code>## $rect
## $rect$w
## [1] 33.53141
## 
## $rect$h
## [1] 0.3430588
## 
## $rect$left
## [1] 0
## 
## $rect$top
## [1] 3.627765
## 
## 
## $text
## $text$x
## [1]  1.562143  8.190318 14.818492 21.446667 28.074842
## 
## $text$y
## [1] 3.456235 3.456235 3.456235 3.456235 3.456235</code></pre>
<p>In this specific case, I am looking for <code>lg$rect$w</code> which gives the width of the first legend. I can use that to set up the placement of my second legend:</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(nyc<span class="op">$</span>amtcapita))<span class="op">~</span>nyc<span class="op">$</span>poverty)
x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">60</span>
y &lt;-<span class="st"> </span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">1</span>])<span class="op">*</span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">2</span>])<span class="op">^</span>x
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">xpd=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, 
     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,
     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,
     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>color_choices[nyc<span class="op">$</span>borough], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>), 
     <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)
<span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,
     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), 
                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">lines</span>(x,y, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;grey20&quot;</span>)
lg &lt;-<span class="st"> </span><span class="kw">legend</span>(<span class="dv">0</span>, <span class="dv">100000</span>, 
             <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Manhattan&quot;</span>,<span class="st">&quot;Bronx&quot;</span>,<span class="st">&quot;Brooklyn&quot;</span>,<span class="st">&quot;Queens&quot;</span>,<span class="st">&quot;Staten Island&quot;</span>), 
             <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">pt.bg=</span>color_choices, <span class="dt">ncol=</span><span class="dv">5</span>,
             <span class="dt">cex=</span><span class="fl">0.45</span>, <span class="dt">pt.cex=</span><span class="fl">1.2</span>, <span class="dt">yjust=</span><span class="op">-</span><span class="fl">0.7</span>)
<span class="kw">legend</span>(lg<span class="op">$</span>rect<span class="op">$</span>w<span class="op">*</span><span class="fl">1.05</span>, <span class="dv">100000</span>, 
       <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;5000 people&quot;</span>,<span class="st">&quot;50,000 people&quot;</span>,<span class="st">&quot;100,000 people&quot;</span>),
       <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">pt.bg=</span><span class="st">&quot;grey&quot;</span>,<span class="dt">ncol=</span><span class="dv">3</span>,
       <span class="dt">pt.cex=</span><span class="kw">log</span>(<span class="kw">c</span>(<span class="dv">5000</span>,<span class="dv">50000</span>,<span class="dv">100000</span>)<span class="op">/</span><span class="dv">3000</span>, <span class="dv">5</span>),
       <span class="dt">yjust=</span><span class="op">-</span><span class="fl">0.7</span>, <span class="dt">cex=</span><span class="fl">0.45</span>)</code></pre>
<p><img src="stat_book_files/figure-html/pretty16-1.png" width="672" /></p>
<p>And there is the final product. Keep in mind that some of the final touches here are fairly complex. I am not expecting you to be able to produce graphs of this complexity tomorrow. The goal was to show you the richness and depth of graphing in R and to give you some reference points for beginning to build your own beautiful graphs.</p>
<p>The <code>plot</code> function is one of the most basic functions for creating plots and once you get the basics down you can create a wide variety of two-dimensional plots. However, there are a variety of other functions that will draw more specific plots. We have already seen examples of <code>pie</code>, <code>barplot</code>, <code>hist</code>, and <code>boxplot</code>. Most of the options for customization that are available for <code>plot</code> are also available for these other functions. For example, in the code here I use the <code>text</code> function to plot the actual percentage values at the top of my bars for a barplot of movie maturity rating and to create lines for the y-axis at 10% intervals.</p>
<pre class="sourceCode r"><code class="sourceCode r">percent &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">table</span>(movies<span class="op">$</span>Rating)<span class="op">/</span><span class="kw">sum</span>(<span class="kw">table</span>(movies<span class="op">$</span>Rating)),<span class="dv">1</span>)
b &lt;-<span class="st"> </span><span class="kw">barplot</span>(percent, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">ylab=</span><span class="st">&quot;Percent&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="dt">col=</span><span class="st">&quot;salmon&quot;</span>)
<span class="kw">text</span>(b[,<span class="dv">1</span>], percent<span class="op">+</span><span class="dv">2</span>, <span class="kw">paste</span>(percent, <span class="st">&quot;%&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">10</span>,<span class="dt">to=</span><span class="dv">50</span>,<span class="dt">by=</span><span class="dv">10</span>), <span class="dt">lwd=</span><span class="fl">0.5</span>, <span class="dt">col=</span><span class="st">&quot;grey80&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</code></pre>
<p><img src="stat_book_files/figure-html/barplot_rating-1.png" width="672" /></p>
<p>Another useful command that we haven’t learned yet is <code>matplot</code> which is short for matrix plotting. The <code>matplot</code> function will plot the values of one dimension of the matrix across the indices of the other dimension. This allows you to plot, for example, trend lines separately by different categories. Lets try it out by plotting the time trend in movie runtime separately by maturity rating. The first step in doing this is to calculate the mean of movie runtime by year and maturity rating using the <code>tapply</code> command.</p>
<pre class="sourceCode r"><code class="sourceCode r">tab &lt;-<span class="st"> </span><span class="kw">tapply</span>(movies<span class="op">$</span>Runtime, movies[,<span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>,<span class="st">&quot;Rating&quot;</span>)], mean)
tab</code></pre>
<pre><code>##       Rating
## Year           G        PG    PG-13        R
##   2001  89.20000 101.43750 105.1667 107.1744
##   2002  92.66667  97.42308 107.0139 104.3974
##   2003  75.40000  96.08333 109.7143 108.1692
##   2004  93.00000  99.65714 106.2027 105.8769
##   2005  84.83333 100.76471 109.6024 107.8659
##   2006  93.85714  99.30233 107.2118 109.6282
##   2007  99.66667  99.37931 104.7324 107.8900
##   2008  91.44444 101.50000 105.8750 106.4935
##   2009  99.33333  98.24242 107.8481 104.1071
##   2010 103.00000 101.79412 109.4559 102.1495
##   2011  89.33333 100.84000 109.3297 101.5098
##   2012  88.00000  99.87500 109.4400 103.1043
##   2013 104.00000 100.81250 112.7971 103.4904</code></pre>
<p>Now, I can feed this matrix into <code>matplot</code> to see the trend across time. In this case, I am going to leave off NC-17 and Unrated because the small number of movies here makes these measures very noisy.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matplot</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;mean movie runtime&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)</code></pre>
<p><img src="stat_book_files/figure-html/matplot_example-1.png" width="672" /></p>
<p>One interesting trend is that PG-13 movies have become longer than R movies, mostly because the runtime of R movies has gotten progressively smaller since 2006. G movies are also getting slight longer over time, but its highly variable from year to year.</p>
<p>I could have also created this plot with the basic <code>plot</code> command and some <code>lines</code> commands, like so:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dt">xlab=</span><span class="st">&quot;year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;mean movie runtime&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>,
     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">2001</span>,<span class="dv">2013</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">70</span>,<span class="dv">120</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)
<span class="kw">lines</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">1</span>], <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)
<span class="kw">lines</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">2</span>], <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">lines</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">3</span>], <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)
<span class="kw">lines</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">4</span>], <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">legend</span>(<span class="dv">2001</span>, <span class="dv">120</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;G&quot;</span>,<span class="st">&quot;PG&quot;</span>,<span class="st">&quot;PG-13&quot;</span>,<span class="st">&quot;R&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>, 
       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;purple&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">ncol=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="stat_book_files/figure-html/matplot_example2-1.png" width="672" /></p>
<p>The plot command here basically creates an empty canvas because I give a single point coordinate (-1,-1) that is outside the range of my xlim and ylim values. I can then use the <code>lines</code> command to write specific lines onto this blank canvas.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pretty-pictures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ggplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
